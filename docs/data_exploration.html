<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.80">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="placeholder">
<title>twri r-manual - 2&nbsp; Data Exploration</title>
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><link href="./streamflow.html" rel="next">
<link href="./intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script><!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]--><link rel="stylesheet" href="css/twri.scss">
</head>
<body class="floating slimcontent">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <img src="./images/logo-drop.png" alt=""><span class="navbar-title">twri r-manual</span>
  </a>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Exploration</span></h1>
      <button type="button" class="quarto-btn-toggle btn">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-r-basics" aria-expanded="true">R Basics</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-r-basics" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-r-basics" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Fundamentals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_exploration.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Exploration</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-hydrology" aria-expanded="true">Hydrology</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-hydrology" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-hydrology" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./streamflow.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Streamflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stage-discharge.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stage-Discharge Rating Curves</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./drainage-area-ratio.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Drainage Area Ratio</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-water-quality" aria-expanded="true">Water Quality</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-water-quality" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-water-quality" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./water-quality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Water Quality Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./load-duration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Load Duration Curves</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-geospatial" aria-expanded="true">Geospatial</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-geospatial" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-geospatial" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Spatial Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./watershed-delineation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Delineate Watersheds</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./raster-summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Extract Raster Summaries</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#import-data" class="nav-link active" data-scroll-target="#import-data"> <span class="header-section-number">2.1</span> Import Data</a></li>
<li>
<a href="#plot-and-clean-data" class="nav-link" data-scroll-target="#plot-and-clean-data"> <span class="header-section-number">2.2</span> Plot and Clean Data</a>
<ul class="collapse">
<li><a href="#themes" class="nav-link" data-scroll-target="#themes"> <span class="header-section-number">2.2.1</span> Themes</a></li>
</ul>
</li>
<li><a href="#manipulate-and-summarize-data" class="nav-link" data-scroll-target="#manipulate-and-summarize-data"> <span class="header-section-number">2.3</span> Manipulate and Summarize Data</a></li>
<li>
<a href="#export-data" class="nav-link" data-scroll-target="#export-data"> <span class="header-section-number">2.4</span> Export Data</a>
<ul class="collapse">
<li><a href="#figures" class="nav-link" data-scroll-target="#figures"> <span class="header-section-number">2.4.1</span> Figures</a></li>
<li><a href="#tables" class="nav-link" data-scroll-target="#tables"> <span class="header-section-number">2.4.2</span> Tables</a></li>
</ul>
</li>
<li><a href="#workflow" class="nav-link" data-scroll-target="#workflow"> <span class="header-section-number">2.5</span> Workflow</a></li>
</ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header"><h1 class="title display-7"><span id="sec-dataexplore" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Exploration</span></span></h1>
</header><p>This is a basic introduction to importing and tidying, plotting, summarizing, and exporting data using the <em>tidyverse</em> family of functions. This is a very basic primer, for more indepth discussion see: …</p>
<p>To get started, make sure you have the <a href="https://www.tidyverse.org/">tidyverse</a> installed. The tidyverse is actually a set of 8 packages designed to work together using a common set of design philosophies. You can doo all the things described below, without tidyverse packages, but I think it is easier to review code that is written using the tidyverse approach.</p>
<p>Install the required packages:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load the packages (you will get a message indicating some function conflicts, don’t worry about that for now:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>✔ ggplot2 3.3.6     ✔ purrr   0.3.4
✔ tibble  3.1.7     ✔ dplyr   1.0.9
✔ tidyr   1.2.0     ✔ stringr 1.4.0
✔ readr   2.1.2     ✔ forcats 0.5.1</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
</div>
<p>When you load tidyverse, you will see the 8 different packages.</p>
<ul>
<li>
<em>ggplot2</em> is primarily used to plot data.</li>
<li>
<em>tibble</em> is a data structure that extends the native data.frame structure in base R.</li>
<li>
<em>tidyr</em> provides tools to orient or transform data from wide to narrow formats and vice versa. It also allows nesting and unnesting of datasets.</li>
<li>
<em>readr</em> is used to read (and write) data into R from CSV, TSV and other delimited text files.</li>
<li>
<em>purrr</em> is a functional programming toolkit (don’t worry about this for now).</li>
<li>
<em>dplyr</em> provides many functions (creating new variables, grouping by variables, joining data, summarizing data, etc.) for working with tibbles and dataframes.</li>
<li>
<em>stringr</em> has functions for easily manipulating character strings.</li>
<li>
<em>forcats</em> functions for creating and reordering “factor” variables.</li>
</ul>
<section id="import-data" class="level2 page-columns page-full" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="import-data">
<span class="header-section-number">2.1</span> Import Data</h2>
<div class="page-columns page-full"><p>One of the first steps in any data analysis project is importing or reading data into R. For now, we will focus on reading in data from comma separated value (CSV), tab seperated value (TSV), and similar delimited text files. For most projects, it is useful to work off a singular data snapshot. So once you download your data and have it in your project, <em>do not</em> manipulate the data file<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn1" role="doc-endnote"><p><sup>1</sup>&nbsp;Later on we will discuss loading web data sources directly into R, but for most of our work your best bet is to store raw data files inside the project</p></li></div></div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Download Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want to work along, download the following example data export it directly into the <em>data</em> folder in your R project: <a href="https://github.com/TxWRI/r-manual/raw/main/data/tutorial.zip">Data</a></p>
</div>
</div>
<p>Use the <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> function from the <em>readr</em> package to import the data and assign it to a variable. The console will print some information telling you what type of variable it made each column of the csv and if there are any problems.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/easterwood.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>Rows: 4045 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (1): name
dbl  (3): station, dailymaximumdrybulbtemperature, dailyprecipitation
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p><code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> guesses the column types and sometimes it can guess wrong, so the safest option is to tell it what to expect using the <code>col_types</code> argument. This argument takes a string where each character represents one column. Here we will tell it to expect a <code>character, Date, character, number, number</code> which is represented as <code>cDcnn</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/easterwood.csv"</span>,</span>
<span>               col_types <span class="op">=</span> <span class="st">"cDcnn"</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4,045 × 5
   station     date       name                 dailymaximumdry… dailyprecipitat…
   &lt;chr&gt;       &lt;date&gt;     &lt;chr&gt;                           &lt;dbl&gt;            &lt;dbl&gt;
 1 74746003904 2010-07-31 COLLEGE STATION EAS…               99                0
 2 74746003904 2010-08-01 COLLEGE STATION EAS…              102                0
 3 74746003904 2010-08-02 COLLEGE STATION EAS…              101                0
 4 74746003904 2010-08-03 COLLEGE STATION EAS…              100                0
 5 74746003904 2010-08-04 COLLEGE STATION EAS…               99                0
 6 74746003904 2010-08-05 COLLEGE STATION EAS…               99                0
 7 74746003904 2010-08-06 COLLEGE STATION EAS…               99                0
 8 74746003904 2010-08-07 COLLEGE STATION EAS…               99                0
 9 74746003904 2010-08-08 COLLEGE STATION EAS…               99                0
10 74746003904 2010-08-09 COLLEGE STATION EAS…              100                0
# … with 4,035 more rows</code></pre>
</div>
</div>
<p>TSV and other delimited files are read in the same way but with <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> or <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv()</a></code>. If your data is in <code>.xlsx</code> format, the <em>readxl</em> pacakge is required. In <em>readxl</em> there is a <code>read_xlsx()</code> function that works similar to the <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> function except you can specify the sheet and range of cells to read from. The <code>col_types</code> argument also needs to be spelled out as a character vector such as <code>col_types = c("text", "date", "text", "numeric", "numeric")</code>.</p>
<p>If you have multiple files with the same column names you can read them into the same data frame. Here we read in multiple files and are more explicit about defining the column types:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"data/marabwq2020.csv"</span>, <span class="st">"data/marabwq2021.csv"</span>, <span class="st">"data/marcewq2020.csv"</span>, <span class="st">"data/marcewq2021.csv"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">files</span>, </span>
<span>               col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols_only</a></span><span class="op">(</span></span>
<span>                 StationCode <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 DateTimeStamp <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_datetime.html">col_datetime</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"%m/%e/%Y %H:%M"</span><span class="op">)</span>,</span>
<span>                 Temp <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">col_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 F_Temp <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 SpCond <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">col_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 F_SpCond <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 Sal <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">col_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 F_Sal <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 DO_mgl <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">col_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 F_DO_mgl <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_character</a></span><span class="op">(</span><span class="op">)</span></span>
<span>               <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 140,352 × 10
   StationCode DateTimeStamp        Temp F_Temp SpCond F_SpCond   Sal F_Sal
   &lt;fct&gt;       &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
 1 marabwq     2020-01-01 00:00:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 2 marabwq     2020-01-01 00:15:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 3 marabwq     2020-01-01 00:30:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 4 marabwq     2020-01-01 00:45:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 5 marabwq     2020-01-01 01:00:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 6 marabwq     2020-01-01 01:15:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.4 &lt;0&gt;  
 7 marabwq     2020-01-01 01:30:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
 8 marabwq     2020-01-01 01:45:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
 9 marabwq     2020-01-01 02:00:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
10 marabwq     2020-01-01 02:15:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
# … with 140,342 more rows, and 2 more variables: DO_mgl &lt;dbl&gt;, F_DO_mgl &lt;chr&gt;</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>This dataset is from the NOAA NERRS Centralized Data Management Office and provides measures of water quality parameters in the Mission and Aransas (MAR) National Estuarine Research Reserve (NERR)<span class="citation" data-cites="noaanationalestuarineresearchreservesystemnerrsSystemwideMonitoringProgram2022">(<a href="references.html#ref-noaanationalestuarineresearchreservesystemnerrsSystemwideMonitoringProgram2022" role="doc-biblioref">NOAA National Estuarine Research Reserve System (NERRS) 2022</a>)</span>.</p>
</div></div><p>In this data we have a row for each date/time observation with associated columns for Station, Temperature, Specific Conductance, Salinity, and Dissolved Oxygen. The columns with the F_ prefix are qa/qc flags, <code>&lt;0&gt;</code> is accepted data.</p>
</section><section id="plot-and-clean-data" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="plot-and-clean-data">
<span class="header-section-number">2.2</span> Plot and Clean Data</h2>
<p><em>ggplot2</em> is the graphics package for producing layered plots. The underlying philosophy of <em>ggplot2</em> is to iteratively build your plots layer by layer which allows for some sophisticated plots. I won’t go into full details of using <em>ggplot2</em> but lots of information is available in the <a href="https://ggplot2-book.org/index.html">ggplot2 book</a>.</p>
<p>Three key things you need to learn: data, aesthetics, geoms.</p>
<ul>
<li><p>data: a data frame or tibble with the data you want to plot.</p></li>
<li><p>aesthetics mappings (or aes): specify how variables will be visually depicted (x, y, color, shape, size, etc.).</p></li>
<li><p>geoms: are the layers that define how each layer is rendered (points, lines, bars, etc.).</p></li>
</ul>
<p>Using the data we imported from above we can quickly create a basic scatter plot. Note the use of the <code>+</code> symbol to iteratively add layers to our plot. First we specify the data, then the geometry, and the aesthetic for that geom:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DateTimeStamp</span>, y <span class="op">=</span> <span class="va">Temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 4975 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>The above figure demonstrates the importance of plotting your data, the -100 value is clearly an issue. One thing we can do is filter the data to try and track down the issue. The dplyr package provides a number of functions to explore your data. Here, the data is filtered on the Temp column to include data less than -99:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Temp</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">99</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1 × 10
  StationCode DateTimeStamp        Temp F_Temp       SpCond F_SpCond   Sal F_Sal
  &lt;fct&gt;       &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
1 marcewq     2021-08-23 20:45:00  -100 &lt;-3&gt; [GIM] … -1211. &lt;-3&gt; [G…   -99 &lt;-3&gt;…
# … with 2 more variables: DO_mgl &lt;dbl&gt;, F_DO_mgl &lt;chr&gt;</code></pre>
</div>
</div>
<p>The F_Temp qa flag is <code>&lt; -3 &gt;</code> indicating QA rejected the data point. So, let’s update the data to remove data that doesn’t have the <code>&lt; 0 &gt;</code> data flag:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">F_Temp</span> <span class="op">==</span> <span class="st">"&lt;0&gt;"</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 111,090 × 10
   StationCode DateTimeStamp        Temp F_Temp SpCond F_SpCond   Sal F_Sal
   &lt;fct&gt;       &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
 1 marabwq     2020-01-01 00:00:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 2 marabwq     2020-01-01 00:15:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 3 marabwq     2020-01-01 00:30:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 4 marabwq     2020-01-01 00:45:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 5 marabwq     2020-01-01 01:00:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.3 &lt;0&gt;  
 6 marabwq     2020-01-01 01:15:00  15.5 &lt;0&gt;      38.2 &lt;0&gt;       24.4 &lt;0&gt;  
 7 marabwq     2020-01-01 01:30:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
 8 marabwq     2020-01-01 01:45:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
 9 marabwq     2020-01-01 02:00:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
10 marabwq     2020-01-01 02:15:00  15.5 &lt;0&gt;      38.3 &lt;0&gt;       24.4 &lt;0&gt;  
# … with 111,080 more rows, and 2 more variables: DO_mgl &lt;dbl&gt;, F_DO_mgl &lt;chr&gt;</code></pre>
</div>
</div>
<p>This removes about 29,263 observations. Try plotting again:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DateTimeStamp</span>, y <span class="op">=</span> <span class="va">Temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>We can use different geoms to explore the data:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Temp</span>, x <span class="op">=</span> <span class="va">StationCode</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>To explore relationships between two variables, use geom_point and geom_smooth with each variable mapped to x and y. In this example, ggplot2 prints a message indicating 834 rows of data had missing or NA values that could not be plotted. geom_mooth will plot the smooth line (using a loess or gam smooth) between two variables. If you want the linear regression drawn use the argument <code>method = "lm"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Temp</span>, y <span class="op">=</span> <span class="va">DO_mgl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>This is a good example to introduce the other important aesthetics in <em>ggplot2</em>. There is a clear negative relationship between Temperature and Dissolved Oxygen. Our data includes two sites, is there a difference between the two sites? We can map color to the site variable which will color each observation and each smooth a different color. Although shape and color can be used inside the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> mapping function, you can assign them a value in the geom directly. Here we asign values for the shape and alpha properties in the point geom.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Temp</span>, y <span class="op">=</span> <span class="va">DO_mgl</span>, color <span class="op">=</span> <span class="va">StationCode</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>There was no reason to expect a difference and there isn’t. However the plot is muddy because there are so many overlying data points. We can also facet the graph by a variable. The following code also shows how you can just add another layer to your existing ggplot object:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p3</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">StationCode</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>As you can see, ggplot2 allows you to rapidly iterate plots to explore data. When exploring the data, the formatting might not matter much, but if you want to export plots, we also need to take care of labels and general plot visual preferences.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p3</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Temperature [°F]"</span>, y <span class="op">=</span> <span class="st">"Dissolved Oxygen [mg/L]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Stations"</span>,</span>
<span>                      palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aransas Bay"</span>, <span class="st">"Copano East"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<section id="themes" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="themes">
<span class="header-section-number">2.2.1</span> Themes</h3>
<p>ggplot2 has a number of built-in themes. For most of our use cases (reports and papers), the grey background and white lines are not great choices. We recommend using the <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw()</a></code> function at the bare minimum:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>The twriTemplates package is available with a custom theme and some color palettes that are consistent with the Institute’s branding:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"twriTemplates"</span>, </span>
<span>                 repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>txwri <span class="op">=</span> <span class="st">'https://txwri.r-universe.dev'</span>,</span>
<span>                           CRAN <span class="op">=</span> <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TxWRI/twriTemplates">twriTemplates</a></span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://txwri.github.io/twriTemplates/reference/theme_TWRI_print.html">theme_TWRI_print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://txwri.github.io/twriTemplates/reference/scale_custom.html">scale_color_discrete_twri</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Stations"</span>,</span>
<span>                            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aransas Bay"</span>, <span class="st">"Copano East"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
<p>The facet labels are still not very useful. There isn’t an easy way to change this using <em>ggplot2</em>. Instead we can create a new variable using the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function in <em>dplyr</em>. There is more discussion about <em>dplyr</em> in the next section.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>StationName <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"marabwq"</span> <span class="op">~</span> <span class="st">"Aransas Bay"</span>,</span>
<span>    <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"marcewq"</span> <span class="op">~</span> <span class="st">"Copano Bay East"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Temp</span>, y <span class="op">=</span> <span class="va">DO_mgl</span>, color <span class="op">=</span> <span class="va">StationName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">StationName</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Temperature [°F]"</span>, y <span class="op">=</span> <span class="st">"Dissolved Oxygen [mg/L]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://txwri.github.io/twriTemplates/reference/scale_custom.html">scale_color_discrete_twri</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Stations"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://txwri.github.io/twriTemplates/reference/theme_TWRI_print.html">theme_TWRI_print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="1600"></p>
</div>
</div>
</section></section><section id="manipulate-and-summarize-data" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="manipulate-and-summarize-data">
<span class="header-section-number">2.3</span> Manipulate and Summarize Data</h2>
<p><a href="https://dplyr.tidyverse.org/articles/dplyr.html"><em>dplyr</em></a> is a powerful package designed for working with dataframes and tibbles. Read the <a href="https://dplyr.tidyverse.org/articles/dplyr.html"><em>dplyr</em> introduction</a> to get a better sense of all the available functions. Essentially <em>dplyr</em> provides “verb” functions that correspond to how you want to manipulate the dataframe.</p>
<p>Commonly used verbs include:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>: subset the rows based on value</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>: create a new column</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>: subset columns based on names or types</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>: group the data by variable values</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>: summarise the grouped or ungrouped data based on user provided functions</li>
</ul>
<p>There are many other functions, but these cover many use cases for people just getting started. <em>dplyr</em> also provides functions for joining datasets based on common variables, changing the order of a dataframe, calculating cumulative statistics, calculating lag and leading values, and rolling or window rank functions among others. All of these can be very useful to become familiar with.</p>
<p>In this example I want to explore seasonal differences in the water quality parameters. <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> is used to create new variables. ::: {.cell}</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_plot</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># returns DateTimeStamp Value as the month only</span></span>
<span>  <span class="co"># see ?strptime() for more info</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Month <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">DateTimeStamp</span>, <span class="st">"%B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         StationName <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>           <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"marabwq"</span> <span class="op">~</span> <span class="st">"Aransas Bay"</span>,</span>
<span>           <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"marcewq"</span> <span class="op">~</span> <span class="st">"Copano Bay East"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">## months have an inherent order, right now it is alphabetical</span></span>
<span>  <span class="co">## this adds the correct order so it plots nicely</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Month <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/lvls.html">lvls_revalue</a></span><span class="op">(</span><span class="va">Month</span>, <span class="va">month.name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month</span>, y <span class="op">=</span> <span class="va">DO_mgl</span>, fill <span class="op">=</span> <span class="va">StationName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://txwri.github.io/twriTemplates/reference/scale_custom.html">scale_fill_discrete_twri</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Stations"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://txwri.github.io/twriTemplates/reference/theme_TWRI_print.html">theme_TWRI_print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">summary_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 834 rows containing non-finite values (stat_boxplot).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_exploration_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1600"></p>
</div>
<p>:::</p>
<p>Now we have a summary figure, but what about the data? We can use the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> function (depending on your English preference) to calculate some summary statistics for each group.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Month <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">DateTimeStamp</span>, <span class="st">"%B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         StationName <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>           <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"marabwq"</span> <span class="op">~</span> <span class="st">"Aransas Bay"</span>,</span>
<span>           <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"marcewq"</span> <span class="op">~</span> <span class="st">"Copano Bay East"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Month <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/lvls.html">lvls_revalue</a></span><span class="op">(</span><span class="va">Month</span>, <span class="va">month.name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">## create groups to calculate summary stats on</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">StationName</span>, <span class="va">Month</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">## calculate the summary stats</span></span>
<span>  <span class="co">## returns a column for each stat with a row for each group</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DO_mgl</span><span class="op">)</span>,</span>
<span>            Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">DO_mgl</span><span class="op">)</span>,</span>
<span>            Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">DO_mgl</span><span class="op">)</span>,</span>
<span>            <span class="co">## no standard error function in base R</span></span>
<span>            <span class="co">## can calculate manually here</span></span>
<span>            SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">DO_mgl</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">DO_mgl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'StationName'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 24 × 6
# Groups:   StationName [2]
   StationName Month      Mean   Max   Min      SE
   &lt;chr&gt;       &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 Aransas Bay January    8.47  12.1   6.7 0.00870
 2 Aransas Bay February   8.96  13.7   6.4 0.0171 
 3 Aransas Bay March      7.57  10.4   5.6 0.00722
 4 Aransas Bay April      7.12   8.5   5.9 0.00738
 5 Aransas Bay May        6.75   9     4.8 0.00839
 6 Aransas Bay June       5.98   8.1   2.2 0.0109 
 7 Aransas Bay July       5.32   8.2   0.2 0.0180 
 8 Aransas Bay August     5.45   7.4   0.2 0.0114 
 9 Aransas Bay September  5.88   9.2   2.3 0.0111 
10 Aransas Bay October    6.67   9.6   3.2 0.00959
# … with 14 more rows</code></pre>
</div>
</div>
</section><section id="export-data" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="export-data">
<span class="header-section-number">2.4</span> Export Data</h2>
<section id="figures" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="figures">
<span class="header-section-number">2.4.1</span> Figures</h3>
<p>You have created a figure and a table in R. Now you probably need to put it in a report, website, or other self contained file for your boss to look at. For figures created with <em>ggplot2</em>, the <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> option is the easiest option. First I reccomend installing, the <em>ragg</em> package because if it available, <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> will use it. <em>ragg</em> provides higher performance and higher quality images than the graphics devices available in base R.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># install ragg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ragg"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ragg.r-lib.org">ragg</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ggsave defaults to the last plot displayed</span></span>
<span><span class="co">## it is safer to specify which plot you want saved</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"figures/boxplot_mare.png"</span>,</span>
<span>       plot <span class="op">=</span> <span class="va">summary_plot</span>,</span>
<span>       width <span class="op">=</span> <span class="fl">8</span>,</span>
<span>       height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>       dpi <span class="op">=</span> <span class="fl">300</span>,</span>
<span>       units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you have a figure created from something other than a ggplot object, then we need to use the ragg graphics device to save it as a file (this also works with ggplot as demonstrated here). If you don’t have <em>ragg</em> installed, substitute <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> for <code><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># first function creates the device</span></span>
<span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"figures/boxplot_mare.png"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">8</span>,</span>
<span>    height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    res <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span>
<span><span class="co"># copy the plot to the file</span></span>
<span><span class="va">summary_plot</span></span>
<span><span class="co"># turns off the device</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="tables" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="tables">
<span class="header-section-number">2.4.2</span> Tables</h3>
<p><em>readr</em> and <a href="https://docs.ropensci.org/writexl/"><em>writexl</em></a> packages provide the functions required to export data frames to text delimited or Microsoft Excel files.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## write a csv</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">summary_table</span>,</span>
<span>          file <span class="op">=</span> <span class="st">"export_data/monthly_summary_mare.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## or an Excel file</span></span>
<span><span class="co">## uncomment the next line if writexl is not installed</span></span>
<span><span class="co"># install.packages("writexl")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/writexl/">writexl</a></span><span class="op">)</span></span>
<span><span class="co"># one sheet</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/writexl/reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">summary_table</span>,</span>
<span>           path <span class="op">=</span> <span class="st">"export_data/monthly_summary_mare.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or specify sheets</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/writexl/reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>summarysheet <span class="op">=</span> <span class="va">summary_table</span>,</span>
<span>                    rawdatasheet <span class="op">=</span> <span class="va">df</span><span class="op">)</span>,</span>
<span>           path <span class="op">=</span> <span class="st">"export_data/monthly_summary_mare.xlsx"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="workflow" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="workflow">
<span class="header-section-number">2.5</span> Workflow</h2>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Incomplete
</div>
</div>
<div class="callout-body-container callout-body">
<p>Plan to add information on proper workflow. One script to download, clean, and save data that analysis is conducted on.</p>
<p>One script to run the analysis and export data/tables/figures</p>
<p>Metadata, readme, etc.</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-noaanationalestuarineresearchreservesystemnerrsSystemwideMonitoringProgram2022" class="csl-entry" role="doc-biblioentry">
NOAA National Estuarine Research Reserve System (NERRS). 2022. System-Wide Monitoring Program. NOAA NERRS Centralized Data Management Office. <a href="http://cdmo.baruch.sc.edu/">http://cdmo.baruch.sc.edu/</a>.
</div>
</div>
</section></main><!-- /main --><script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Fundamentals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./streamflow.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Streamflow</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://twri.tamu.edu">Texas Water Resources Institute</a>
  </li>  
</ul>
</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>